var urlUsers="http://localhost:8888/db/users.json",urlSeries="http://localhost:8888/db/series.json",urlEvents="http://localhost:8888/db/events.json";function eventUserFetch(){var e=new XMLHttpRequest;e.open("GET",urlUsers),e.onload=function(){eventRotaDefine(JSON.parse(e.responseText))},e.send()}function seriesUserFetch(){var e=new XMLHttpRequest;e.open("GET",urlUsers),e.onload=function(){seriesRotaDefine(JSON.parse(e.responseText))},e.send()}function eventRotaDefine(e){var t=document.getElementById("eventRotaName").value,a=document.getElementById("eventBoatNo").value,o=document.getElementById("eventBoatNoML").value,n=document.getElementById("eventBoatPersonnelNo").value,l={EventName:t,NumberOfBoats:a,NumberOfMarklayers:o,StartDate:document.getElementById("eventDateStart").value,EventLength:document.getElementById("eventDateLength").value,MLBoatDriver:{},MLBoatCrew:{},RBoatDriver:{},RBoatCrew:{}};boatFill=a,console.log("Personnel per boat is set at: "+n);for(var s=0;s<e.length;s++)if(e[s].qualifications.PBL2&&e[s].qualifications.ML&&e[s].age>=16&&boatFill>0&&o>0&&1!=e[s].used){for(var r=0;r<n;r++){1&&(l.MLBoatDriver[boatFill]=e[s].firstName+" "+e[s].lastName,e[s].used=!0,0)}o--,boatFill--}else if(e[s].qualifications.PBL2&&e[s].age>=16&&0==e[s].qualifications.ML&&a>o&&boatFill>0&&1!=e[s].used){for(r=0;r<n;r++){1&&(l.RBoatDriver[boatFill]=e[s].firstName+" "+e[s].lastName,e[s].used=!0,0)}boatFill--}t=document.getElementById("eventRotaName").value,a=document.getElementById("eventBoatNo").value,o=document.getElementById("eventBoatNoML").value,n=document.getElementById("eventBoatPersonnelNo").value,document.getElementById("eventDateStart").value,document.getElementById("eventDateLength").value;boatFill=a;for(s=0;s<e.length;s++)if(e[s].qualifications.PBL2&&boatFill>0&&o>0&&1!=e[s].used){for(r=0;r<n;r++){1&&(l.MLBoatCrew[boatFill]=e[s].firstName+" "+e[s].lastName,e[s].used=!0,0)}o--,boatFill--}else if(e[s].qualifications.PBL2&&a>o&&boatFill>0&&1!=e[s].used){for(r=0;r<n;r++){1&&(l.RBoatCrew[boatFill]=e[s].firstName+" "+e[s].lastName,e[s].used=!0,0)}boatFill--}console.log(l),console.log(e)}function seriesRotaDefine(e){var t=document.getElementById("seriesType").value,a=document.getElementById("seriesBoatNo").value,o=document.getElementById("seriesPersonnelNo").value,n=document.getElementById("seriesStartDate").value,l=document.getElementById("seriesEndDate").value;document.getElementById("EventRotaModal").style.display="none";var s={Name:t,numberOfBoats:a,startDate:n,endDate:l,races:[{},{},{},{},{},{},{},{},{}]};console.log("Personnel per boat is set at: "+o);var r=[];!function(e,t,a,o){for(var n=e,l=t,s=(o=0,["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].indexOf(a));n.getTime()<=l.getTime();)n.getDay()==s&&(o++,r.push(n.toDateString())),n.setDate(n.getDate()+1);datesRequired=o,datesRequired}(new Date(n),new Date(l),"Sun"),console.log("Date List: "),console.log(r),console.log("Number of Sundays is: "+datesRequired);for(var i=0;i<datesRequired;i++){boatFill=a;for(var u=0;u<e.length;u++)if(e[u].qualifications.PBL2&&e[u].age>=16&&boatFill>0&&1!=e[u].used){for(var d=0;d<o;d++)s.races[i].date=r.shift(),s.races[i].RBoatDriver=e[u].firstName+" "+e[u].lastName,e[u].used=!0;boatFill--}boatFill=a;for(u=0;u<e.length;u++)if(e[u].qualifications.PBL2&&boatFill>0&&1!=e[u].used){for(d=0;d<o;d++)console.log("This is run number: "+i),console.log(s),s.races[i].RBoatCrew=e[u].firstName+" "+e[u].lastName,e[u].used=!0;boatFill--}}console.log(i),console.log(e),console.log(s)}function displaySeries(){seriesHeading="<h2>NaN",seriesBoat=cardcontent.insertAdjacentHTML("beforeend",userString)}